<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Lyvo QR</title>
        <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    </head>
    <body>

    <!-- Contenedor donde se mostrará el código QR -->
    <div id="qrcode"></div>
    <div>
        <a href="#" id="link">Historia clínica</a>
    </div>

    <script>
        // Función para obtener la dirección IP y generar el código QR
        function generateQR() {
            // Hacer fetch al archivo PHP para obtener la dirección IP (o cualquier otro dato que devuelve)
            fetch('https://lyvoweb.isostopyserver.net/pages/medicalInformation_link.php')
                .then(response => response.text())
                .then(code => {
                    // Construir la URL con la dirección IP obtenida
                    var url = 'https://lyvoweb.isostopyserver.net/public/medicalInformation_print.php?user=' + code;
                    
                    var enlace = document.getElementById('link');
                    enlace.href = url;

                    // Generar el código QR con la URL construida
                    new QRCode("qrcode", {
                        text: url,
                        width: 128,
                        height: 128,
                    });
                })
                .catch(error => console.error('Error al obtener la IP:', error));
        }

        // Ejecutar la función de generación automáticamente al cargar la página
        window.onload = generateQR;

    </script>

    </body>
</html>